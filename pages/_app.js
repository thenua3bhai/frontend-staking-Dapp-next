import "@/styles/globals.css";
import "@rainbow-me/rainbowkit/styles.css";
import { getDefaultWallets, RainbowKitProvider } from "@rainbow-me/rainbowkit";
import { configureChains, createClient, WagmiConfig } from "wagmi";
import { goerli, hardhat, sepolia } from "wagmi/chains";
import { alchemyProvider } from "wagmi/providers/alchemy";
import { jsonRpcProvider } from "@wagmi/core/providers/jsonRpc";
import { infuraProvider } from "wagmi/providers/infura";
import { publicProvider } from "wagmi/providers/public";
import Head from "next/head";
import Header from "@/components/Header";
import { HomeProvider } from "@/contexts/stakingContext";
import { ContractDataProvider } from "@/contexts/contractDataContext";
import { ToastContainer } from "react-toastify";

export default function App({ Component, pageProps }) {
  const { chains, provider } = configureChains(
    [goerli, sepolia, hardhat],
    [
      infuraProvider({ apiKey: process.env.NEXT_PUBLIC_INFURA_ID_GOERLI }),
      publicProvider(),
      alchemyProvider({ apiKey: process.env.NEXT_PUBLIC_INFURA_ID_SEPOLIA }),
      jsonRpcProvider({
        rpc: (chain) => ({
          http: `http://127.0.0.1:8545/`,
        }),
      }),
    ]
  );

  const { connectors } = getDefaultWallets({
    appName: "My RainbowKit App",
    chains,
  });
  const wagmiClient = createClient({
    autoConnect: true,
    connectors,
    provider,
  });
  return (
    <WagmiConfig client={wagmiClient}>
      <RainbowKitProvider chains={chains}>
        <HomeProvider>
          <ContractDataProvider>
            <Head>
              <title>Staking DApp</title>
              <meta name="description" content="Generated by create next app" />
              <meta name="viewport" content="width=device-width, initial-scale=1" />
              <link rel="icon" href="/favicon.ico" />
            </Head>
            <Header />
            <ToastContainer />

            <Component {...pageProps} />
          </ContractDataProvider>
        </HomeProvider>
      </RainbowKitProvider>
    </WagmiConfig>
  );
}
